@page "/logout"
@using Microsoft.AspNetCore.Authentication
@using Microsoft.AspNetCore.Identity
@inject NavigationManager Navigation
@inject CustomAuthenticationStateProvider AuthStateProvider
@inject IHttpContextAccessor HttpContextAccessor

<PageTitle>Logout</PageTitle>

<div class="flex flex-col items-center justify-center min-h-screen bg-gray-100 text-center px-4">
    <h2 class="text-3xl font-bold text-gray-800 mb-4">Logging out...</h2>
    <p class="text-gray-600">Please wait while we log you out and redirect you.</p>
</div>

@code {
    protected override async Task OnInitializedAsync()
    {
        // 1. Remove ASP.NET Core Identity cookie
        await HttpContextAccessor.HttpContext.SignOutAsync(IdentityConstants.ApplicationScheme);

        // 2. Notify Blazor AuthenticationStateProvider
        AuthStateProvider.MarkUserAsLoggedOut();

        Navigation.NavigateTo("/", true);   
    }
}
